!function(){function a(a){var b=new Date(a.getFullYear(),a.getMonth()+1,0),c=+f(a),d=+g(a),h=+f(b),i=+g(b);return"M"+(d+1)*e+","+c*e+"H"+d*e+"V"+7*e+"H"+i*e+"V"+(h+1)*e+"H"+(i+1)*e+"V0H"+(d+1)*e+"Z"}var b=13,c=960,d=136,e=17,f=d3.time.format("%w"),g=d3.time.format("%U"),h=d3.time.format("%Y-%m-%d"),i=d3.scale.quantize().domain([0,b]).range(d3.range(b).map(function(a){return"q"+a+"-13"})),j=d3.select("body").selectAll("svg").data(d3.range(1980,1985)).enter().append("svg").attr("width",c).attr("height",d).attr("class","RdYlGn").append("g").attr("transform","translate("+(c-53*e)/2+","+(d-7*e-1)+")");j.append("text").attr("transform","translate(-6,"+3.5*e+")rotate(-90)").style("text-anchor","middle").text(function(a){return a});var k=j.selectAll(".day").data(function(a){return d3.time.days(new Date(a,0,1),new Date(a+1,0,1))}).enter().append("rect").attr("class","day").attr("width",e).attr("height",e).attr("x",function(a){return g(a)*e}).attr("y",function(a){return f(a)*e}).datum(h);k.append("title").text(function(a){return a}),j.selectAll(".month").data(function(a){return d3.time.months(new Date(a,0,1),new Date(a+1,0,1))}).enter().append("path").attr("class","month").attr("d",a),d3.csv("../data/part_91_csv/data_1980_84.csv",function(a,b){var c=d3.nest().key(function(a){return a.date}).rollup(function(a){return d3.sum(a,function(a){return null!==a.fatalities?parseInt(a.fatalities):0})}).map(b);data_csv=b,k.filter(function(a){return a in c}).attr("class",function(a){return console.log(c[a]),"day "+i(c[a])}).select("title").text(function(a){return 0==c[a]?a+": No accidents!":1==c[a]?a+": "+c[a]+" accident":a+": "+c[a]+" accidents"})})}(),d3.select(self.frameElement).style("height","2910px"),d3.select("#side-button").on("click",function(){});